<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>12.&nbsp;Development Reference Manual</title><link rel="stylesheet" href="html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.68.1"><link rel="start" href="index.html" title="LIMS Help Pages"><link rel="up" href="ch20.html" title="Chapter&nbsp;20.&nbsp;Development"><link rel="prev" href="ch20s11.html" title="11.&nbsp;LIMS Test Protocol - Live database test (use Beta database)"><link rel="next" href="ch20s13.html" title="13.&nbsp;Internal System Testing"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">12.&nbsp;Development Reference Manual</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch20s11.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;20.&nbsp;Development</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch20s13.html">Next</a></td></tr></table><hr></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e14217"></a>12.&nbsp;Development Reference Manual</h2></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e14220"></a>12.1.&nbsp;Barcoding</h3></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e14223"></a>12.1.1.&nbsp;Barcoding Symbologies</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Sequencing Lab:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>1D barcode (code128 symbology) - all barcoding needs</p></li></ul></div></li><li style="list-style-type: circle"><p>Gene Expression Lab:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>1D barcode (code128 symbology) - all barcoding needs except for tubes</p></li><li style="list-style-type: circle"><p>2D barcode (Data Matrix symbology) - all barcoding needs for tubes (e.g. samples, reagents, libraries, etc)</p></li></ul></div></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e14246"></a>12.1.2.&nbsp;Barcoding Products</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Sequencing Lab</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Printers</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>203 DPI printer</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Zebra S600 203 DPI printer</p></li></ul></div></li></ul></div></li><li style="list-style-type: circle"><p>Scanners</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Wireless handheld scanner</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Symbol PPT 2846</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Ordered from AdvAnce Micro Solutions Ltd.</p></li><li style="list-style-type: circle"><p>Contact person: ; Roger Yip (ryip@ad-micro.com)</p></li></ul></div></li></ul></div></li></ul></div></li></ul></div></li></ul></div><div class="table"><a name="d0e14289"></a><p class="title"><b>Table&nbsp;20.4.&nbsp;</b></p><table summary="" border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th>Item</th><th>Catalog #</th><th>Description</th><th>Price (Cdn.)</th></tr></thead><tbody><tr><td>Symbol PPT2846 1D scanner</td><td>PPT2846-TRBZ0YUS</td><td>64M Ram, 32M Rom, color display, 1D, 802.11b, 1 year warranty</td><td>$2180.00</td></tr><tr><td>Charging crad</td><td>CRD2X00-100S</td><td>1 slot charging cradle with power supply</td><td>$206.00</td></tr></tbody></table></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Labels</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Steve M. and Carrie J. from Purchasing handles the ordering of these labels. ; I believe they got it from Integrated Labeling Systems, Inc.</p></li></ul></div></li></ul></div></li><li style="list-style-type: circle"><p>Gene Expression Lab</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Printers</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>300 DPI printer</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Zebra Z4M Plus 300 DBI printer</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Ordered from AdvAnce Micro Solutions Ltd.</p></li><li style="list-style-type: circle"><p>Contact person: ; Roger Yip (ryip@ad-micro.com)</p></li></ul></div></li></ul></div></li></ul></div></li></ul></div></li></ul></div><div class="table"><a name="d0e14358"></a><p class="title"><b>Table&nbsp;20.5.&nbsp;</b></p><table summary="" border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th>Item</th><th>Catalog #</th><th>Description</th><th>Price (Cdn.)</th></tr></thead><tbody><tr><td>Zebra Z4M Plus 300 DPI Printer</td><td>Z4M00-3001-0000</td><td>thermal printer, parallel/serial 8M Dram 2M Flash</td><td>$1950.00</td></tr><tr><td>Zebra Resin Ribbon</td><td>5095BK06045</td><td>resin ribbon 2.36"x1476'</td><td>$50.00 per roll</td></tr></tbody></table></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Scanners</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Workstation scanner</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Code Reader 2.0</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Ordered from Brady/Fisher Scientific</p></li><li style="list-style-type: circle"><p>More info can be found at &gt; <a href="http://www.codecorp.com" target="_top"> http://www.codecorp.com</a></p></li><li style="list-style-type: circle"><p>Contact person: ; Lynn Wilson (Lynn_Wilson@bradycorp.com)</p></li></ul></div></li></ul></div></li></ul></div></li></ul></div><div class="table"><a name="d0e14417"></a><p class="title"><b>Table&nbsp;20.6.&nbsp;</b></p><table summary="" border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th>Item</th><th>Catalog #</th><th>Description</th><th>Price (Cdn.)</th></tr></thead><tbody><tr><td>CR 2.0 WIRED, GUN-HANDLE, USB CONFIGURATION</td><td>89355&gt;</td><td>The actual scanner</td><td>$859.78</td></tr><tr><td>CR 2.0 WIRED, STAND</td><td>63766</td><td>The metal stand</td><td>$184.8</td></tr></tbody></table></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Wireless handheld scanner</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Symbol PPT 8146</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Ordered from AdvAnce Micro Solutions Ltd.</p></li><li style="list-style-type: circle"><p>Contact person: ; Roger Yip (ryip@ad-micro.com)</p></li></ul></div></li></ul></div></li></ul></div><div class="table"><a name="d0e14466"></a><p class="title"><b>Table&nbsp;20.7.&nbsp;</b></p><table summary="" border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th>Item</th><th>Catalog #</th><th>Description</th><th>Price (Cdn.)</th></tr></thead><tbody><tr><td>Symbol PPT8416 2D scanner</td><td>PDT8146 XScale</td><td>Imager, S24 11Mbps, Pocket PC 2002, color display, 64M Ram/Rom, 37-key Battery is included</td><td>$3475.00</td></tr><tr><td>Charging cradle</td><td>CRD8100-1200S&gt;</td><td>1 slot serial cradle with power supply</td><td>$200.00</td></tr></tbody></table></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Labels</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>1D labels</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Standard room temperature 2.25" x .75" direct thermal label</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Ordered from Maximum Barcode Inc.</p></li><li style="list-style-type: circle"><p>More info can be found at <a href="http://www.maximumbarcode.com" target="_top">http://www.maximumbarcode.com</a></p></li><li style="list-style-type: circle"><p>Contact person: ; Bruce Gagnon (bgagnon@maximumbarcode.com)</p></li><li style="list-style-type: circle"><p>Note: Steve M. from Purchasing found out that we can order the same labels from Integrated Labeling Systems, Inc. with the price of $14.38 per roll! ; We should contact these guys if we need more of these in the future. ; Contact Person: ; Doris J. Petroules (dpetroules@integratedlabeling.com)</p></li></ul></div></li></ul></div></li></ul></div></li></ul></div><div class="table"><a name="d0e14528"></a><p class="title"><b>Table&nbsp;20.8.&nbsp;</b></p><table summary="" border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th>Item</th><th>Catalog #</th><th>Description</th><th>Price (Cdn.)</th></tr></thead><tbody><tr><td>Case of 4 rolls 2.25" x .75" Direct Thermal 7995 Labels</td><td>800622-075</td><td>It must come in case of 4 rolls</td><td>$90.60 per roll</td></tr></tbody></table></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>2D labels</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Circular label for 2D barcodes with rectangular label</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Ordered from Brady/Fisher Scientific</p></li><li style="list-style-type: circle"><p>Contact person: ; Lynn Wilson (Lynn_Wilson@bradycorp.com)</p></li></ul></div></li></ul></div></li></ul></div><div class="table"><a name="d0e14568"></a><p class="title"><b>Table&nbsp;20.9.&nbsp;</b></p><table summary="" border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th>Item</th><th>Catalog #</th><th>Description</th><th>Price (Cdn.)</th></tr></thead><tbody><tr><td>0.900 inches x 0.500 inches rectangular labels with 0.500 diameters circular labels</td><td>THT-126-499-3</td><td>&nbsp;</td><td>$154.65&gt;</td></tr></tbody></table></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e14590"></a>12.2.&nbsp;Database Batch Conversions/Modifications</h3></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e14593"></a>12.2.1.&nbsp;Overview</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>The bin/convert_DB.pl script provides various database batch conversion/modifications functionalities.</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e14600"></a>12.2.2.&nbsp;Details</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Functionalities supported:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Batch conversion of tables from MyISAM to InnoDB.</p></li><li style="list-style-type: circle"><p>Batch creation of missing indices for FK fields.</p></li><li style="list-style-type: circle"><p>Batch creation of MySQL foreign key constraints for FK fields (also have the option of fixing the field definition of FK fields if they don't match the field definition of the corresponding primary key fields)</p></li></ul></div></li><li style="list-style-type: circle"><p>Operations can be done to all tables in the database or a comma-delimited list of tables specified.</p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e14621"></a>12.3.&nbsp;Data Integrity</h3></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e14624"></a>12.3.1.&nbsp;Overview</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>In the LIMS, the followings help to maintain data integrity:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Data integrity checks by functions in SDB::GSDB that performs inserts, updates and deletes. (i.e. Table_update(), Table_update_array(), Table_append(), Table_append_array(), delete_records(), delete_record())</p></li><li style="list-style-type: circle"><p>MySQL transactions (see Developer's Manual - Transaction</p></li><li style="list-style-type: circle"><p>MySQL foreign keys (to be implemented in the future)</p></li><li style="list-style-type: circle"><p>DB Integrity Checker - This tool monitors data integrity and reports problems found</p></li><li style="list-style-type: circle"><p>bin/fix_data.pl - Custom defined data fixes</p></li></ul></div></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e14648"></a>12.3.2.&nbsp;Details</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>DB Integrity Checker:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Composed of:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>cgi-bin/DBIntegrity.pl</p></li><li style="list-style-type: circle"><p>alDente/DBIntegrity.pm</p></li></ul></div></li><li style="list-style-type: circle"><p>Has both a web and command-line interface</p></li><li style="list-style-type: circle"><p>Performs 2 types of checks:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Foreign key checks - Checks orphan child records that point to no parents</p></li><li style="list-style-type: circle"><p>Custom defined error checks</p></li></ul></div></li><li style="list-style-type: circle"><p>Use the -h switch for help information</p></li><li style="list-style-type: circle"><p>This script is run as a cron job under sequence@seqdb01</p></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>bin/fix_data.pl</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Consists of blocks of data integrity checks and fixes</p></li><li style="list-style-type: circle"><p>Use the -h switch for help information</p></li><li style="list-style-type: circle"><p>This script is run as a cron job under aldente@seqdb01</p></li></ul></div></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e14703"></a>12.4.&nbsp;Database Monitor</h3></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e14706"></a>12.4.1.&nbsp;Overview</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>The bin/DB_monitor.pl script provides several database space usage monitoring functionalities.</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e14713"></a>12.4.2.&nbsp;Details</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Functionalities provided:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>For a user-specified list of hosts and databases:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Report space usage</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Detail mode - report space usage for tables as well as total usage of the database</p></li><li style="list-style-type: circle"><p>Summary mode - only report total usage of the database</p></li><li style="list-style-type: circle"><p>Log mode - logs space usage information to a log file (this log file is automatically written by the script in XML format)</p></li><li style="list-style-type: circle"><p>View mode - view space usage statistics over time based on information stored in the XML log file</p></li></ul></div></li></ul></div></li></ul></div></li><li style="list-style-type: circle"><p>Right now this script is run as a cron job under aldente@seqdb01.</p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e14747"></a>12.5.&nbsp;Development / Release protocols</h3></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e14750"></a>12.5.1.&nbsp;Requirement Review</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Any new features should be entered and tracked in the Issues Tracker as an Enhancement with Priority and Severity assigned.</p></li><li style="list-style-type: circle"><p>For features requested by users, there should always be a review with the users.</p></li><li style="list-style-type: circle"><p>For features requested by developers:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>If priority is Critical/High and/or severity is Fatal/Major, there should be a review by another developer.</p></li><li style="list-style-type: circle"><p>If severity is Minor/Cosmetic, the review is optional.</p></li></ul></div></li><li style="list-style-type: circle"><p>For features that are requested after the initial requirements gathering phase:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Features that require a lot of coding will be deferred to the next development cycle.</p></li><li style="list-style-type: circle"><p>Features that do not require a lot of coding or features that are related to an existing feature request may be implemented in the current development cycle.</p></li></ul></div></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e14782"></a>12.5.2.&nbsp;Design protocols</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>For features that have priority of Critical/High and/or severity of Fatal/Major, the design should be reviewed by at least one other developer.</p></li><li style="list-style-type: circle"><p>For features that require more than a day or two of work, a design strategy should be laid out in a documented work package.</p></li><li style="list-style-type: circle"><p>For features that are very straight forward, developers may use their judgement to forego a formalized design process.</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e14795"></a>12.5.3.&nbsp;Development</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Code that is non-trivial in nature (more than a couple of pages of code) should be reviewed by another developer before being closed.</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e14802"></a>12.5.4.&nbsp;User Integration and Test</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>All new features should be thoroughly tested.</p></li><li style="list-style-type: circle"><p>Features that have priority of Critical/High and/or severity of Fatal/Major should be briefly tested by another developer as well.</p></li><li style="list-style-type: circle"><p>All defects found within this phase should be submitted to the Issues Tracker right away with Priority and Severity assigned.</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Defects that have priority of Critical/High must be fixed before the release.</p></li><li style="list-style-type: circle"><p>Defects that have priority of Medium/Low will be deferred to the next release.</p></li></ul></div></li><li style="list-style-type: circle"><p>Refer to the Testing Protocol help page for details on what should be tested and how the testing should be done.</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e14826"></a>12.5.5.&nbsp;Release</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>A release will be made only when all affected labs have finished beta testing and all concerned lab admins have signed off on the release.</p></li><li style="list-style-type: circle"><p>A release will only be made if there are no outstanding Critical/High defects found in the Beta Version for the last 0.5 days.</p></li><li style="list-style-type: circle"><p>A release will ideally be made on a weekend so any release problems can be addressed by an on-duty LIMS admin during the weekend.</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e14839"></a>12.5.6.&nbsp;Procedures for Release Process and Ongoing Development</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>The steps for the release process are as follows (assuming the new release is release 2.30 and will be tagged ;seqdb01-2_30 while the old release is release 2.20):</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Turn off all cron jobs in seqdb01, lims-dbm, plebe, plebe2, and lims01 that are run by 'sequence' and 'aldente' users (this is required for upgrades that takes a long time; otherwise can be skipped)</p></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Login as the 'aldente' user</p></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Under <code class="filename"> /opt/alDente/versions/</code></p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Create a copy of the svn trunk as a branch called seqdb01-2_30-branch</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>svn copy http://svn/lims/alDente/trunk http://svn/lims/alDente/branches/seqdb01-2_30-branch</p></li></ul></div></li><li style="list-style-type: circle"><p>Check out the new branch to the new seqdb01-2_30 folder seqdb01-2_30 folder:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>svn checkout http://svn/lims/alDente/branches/seqdb01-2_30-branch seqdb01-2_30</p></li></ul></div></li><li style="list-style-type: circle"><p>Make sure that the checkout used the appropriate branch</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>svn info seqdb01-2_30</p></li></ul></div></li><li style="list-style-type: circle"><p>Generate the system configuation file:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>install/setup.pl</p></li><li style="list-style-type: circle"><p>ensure the sql database hosts are set correctly (in this case SQL_HOST should be set to the master host seqdb01)</p></li></ul></div></li><li style="list-style-type: circle"><p>Backup the production database by running (this is required if the database upgrade is invasive - just to be safe):</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>bin/backup_DB.pl -h seqdb01 -D sequence -u viewer -p viewer -P /home/sequence/alDente/dumps/sequence.pre-2_30 &gt; /opt/alDente/www/dynamic/logs/sequence.pre-2_30.backup.log</p></li><li style="list-style-type: circle"><p>Verify the dumps are actually created</p></li></ul></div></li><li style="list-style-type: circle"><p>Relink the symbolic link &#8220;<span class="quote">production</span>&#8221; to the &#8220;<span class="quote"> seqdb01-2_30</span>&#8221; folder:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>rm -f production; ln -s seqdb01-2_30 production</p></li></ul></div></li><li style="list-style-type: circle"><p>Create the symbolic link cgi-bin/scanner.pl from cgi-bin/barcode.pl</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>ln -s barcode.pl scanner.pl</p></li></ul></div></li><li style="list-style-type: circle"><p>Upgrade the production database by running:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>bin/upgrade_DB.pl -A all -D seqdb01:sequence -u username -p password -S -b all -l -f &amp;&amp; /opt/alDente/www/dynamic/logs/sequence.2_30.upgrade.log</p></li></ul></div></li><li style="list-style-type: circle"><p>After upgrade is done, test to make sure page is still working (Perhaps restore a seqtest database to do extensive testing)</p></li><li style="list-style-type: circle"><p>Turn the cron jobs in seqdb01, lims-dbm, plebe and plebe2 run by 'sequence' and 'aldente' users back on again (this is required for upgrades that takes a long time; otherwise can be skipped)</p></li><li style="list-style-type: circle"><p>Checkout another copy of the production branch to the &#8220;<span class="quote">seqdb01-2_30-hotfix</span>&#8221; folder. This folder will be used for making hotfixes in the future:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>svn checkout http://svn/lims/alDente/branches/seqdb01-2_30-branch seqdb01-2_30-hotfix</p></li></ul></div></li><li style="list-style-type: circle"><p>Copy the system configuration file over:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>cp seqdb01-2_30/conf/system.conf seqdb01-2_30-hotfix/conf/</p></li></ul></div></li><li style="list-style-type: circle"><p>Relink the symbolic link &#8220;<span class="quote">test</span>&#8221; to the &#8220;<span class="quote">seqdb01-2_30-hotfix</span>&#8221; folder:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>rm -f test &amp;&amp; ln -s seqdb01-2_30-hotfix test</p></li></ul></div></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Relink the symbolic link &#8220;<span class="quote">last</span>&#8221; to the&#8220;<span class="quote"> seqdb01-2_20</span>&#8221; folder:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>rm -f last &amp;&amp; ln -s seqdb01-2_20 last</p></li></ul></div></li><li style="list-style-type: circle"><p>Under &#8220;<span class="quote">production/www</span>&#8221;, create the symlink &#8220;<span class="quote">share</span>&#8221; to &#8220;<span class="quote">/home/sequence/alDente/share/:</span>&#8221;</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>ln -s /home/sequence/alDente/share share</p></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Create a tag of the branch to allow access to the original seqdb01-2_30 code release</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>svn copy http://svn/lims/alDente/branch/seqdb01-2_30-branch http://svn/lims/alDente/tags/seqdb01-2_30</p></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Under &#8220;<span class="quote"> /home/sequence/alDente/WebVersions/:</span>&#8221;</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>&gt;check out the production version from the branch:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>svn checkout http://svn/lims/alDente/branches/seqdb01-2_30-branch seqdb01-2_30</p></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Create the system configuration file by running setup.pl:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>install/setup.pl</p></li><li style="list-style-type: circle"><p>Ensure the sql database hosts are set correctly. (in this case SQL_HOST should be set to the slave host lims-dbm)</p></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Relink the symbolic link &#8220;<span class="quote">Production</span>&#8221; to the &#8220;<span class="quote">seqdb01-2_30</span>&#8221; folder:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>rm -f Production &amp;&amp; ln -s seqdb01-2_30 Production</p></li></ul></div></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Send email notification to lab users about the new release.</p></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Ongoing development (under &#8220;<span class="quote">/opt/alDente/versions/)</span>&#8221;:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>New code development (development stream):</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Now that release 2.30 is out, say you are starting to work on new features for release 2.30. ;Assuming your ongoing code development folder is &#8220;<span class="quote"> achan </span>&#8221;, make sure you have the latest code - under &#8220;<span class="quote">/opt/alDente/versions/achan/</span>&#8221;:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>svn update</p></li></ul></div></li><li style="list-style-type: circle"><p>Develop code and commit changes to Subversion as usual.</p></li></ul></div></li><li style="list-style-type: circle"><p>Hotfixes/maintenance on existing production version (production stream):</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Say there is now a bug in the production version requiring a hotfix. ;First make sure the &#8220;<span class="quote">hotfix </span>&#8221; folder contains the latest code from the current production branch - under &#8220;<span class="quote">/opt/alDente/versions/test/</span>&#8221;:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>svn update</p></li></ul></div></li><li style="list-style-type: circle"><p>Make the require coding changes, test the changes and then svn commit the changes.</p></li><li style="list-style-type: circle"><p>Now it's time to put your hotfix into the &#8220;<span class="quote">production</span>&#8221; folder. To be absolutely safe about the changes to be applied, first do an svn diff to find out the changes to be applied (say the file that was changed is cgi-bin/barcode.pl) - under ;&#8220;<span class="quote">/opt/alDente/versions/production/</span>&#8221;:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>svn diff cgi-bin/barcode.pl</p></li><li style="list-style-type: circle"><p>svn status cgi-bin/barcode.pl -u</p></li></ul></div></li></ul></div></li><li style="list-style-type: circle"><p>If the changes look OK, then update the code in the production folder - under ;&#8220;<span class="quote">/opt/alDente/versions/production/</span>&#8221;:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>svn update cgi-bin/barcode.pl</p></li></ul></div></li><li style="list-style-type: circle"><p>After making sure the production version is ok, it is crucial that you also merge the same hotfix changes to the development stream. ;The sooner you do the merge, the lower the chance a conflict will occur.</p></li></ul></div></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e15149"></a>12.6.&nbsp;Extraction</h3></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e15152"></a>12.6.1.&nbsp;Overview</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Since release 2.1, lab admin can setup an extraction step as a special type of transfer/aliquot step.</p></li><li style="list-style-type: circle"><p>For an extraction step:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>The step name will be auto generated just like a transfer/aliquot step. ; The difference is rather than something a step name like 'Transfer to 1.5 ml Tube', an extraction step will be something like 'Transfer RNA to 1.5 ml Tube', in which 'RNA' represents the type of sample that the step is extracting.</p></li><li style="list-style-type: circle"><p>Right now in the system there are 4 types of samples available for extraction: ; DNA, RNA, Protein, Mixed</p></li></ul></div></li><li style="list-style-type: circle"><p>For details on how usage of extraction, please refer to the Extraction Manual.</p></li><li style="list-style-type: circle"><p>Also, we introduced a new type of sample call Extraction Sample for samples in Gene Expression department. ; This is analagous to Clone Sample for Sequencing.</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e15176"></a>12.6.2.&nbsp;Database Tables</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Extraction</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><pre class="programlisting">+--------------------+---------+------+-----+---------+----------------+
| Field              | Type    | Null | Key | Default | Extra          |
+--------------------+---------+------+-----+---------+----------------+
| Extraction_ID      | int(11) |      | PRI | NULL    | auto_increment |
| FKSource_Plate__ID | int(11) |      | MUL | 0       |                |
| FKTarget_Plate__ID | int(11) |      | MUL | 0       |                |
+--------------------+---------+------+-----+---------+----------------+</pre></li><li style="list-style-type: circle"><p>Fields:</p><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>FKSource_Plate__ID - The plate ID where the extraction is coming from</p></li><li style="list-style-type: circle"><p>FKTarget_Plate__ID - The plate ID where the extraction is going to</p></li></ul></div></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Extraction_Sample</p></li><li style="list-style-type: circle"><pre class="programlisting">+------------------------+-------------------------------------+------+-----+---------+----------------+
| Field                  | Type                                | Null | Key | Default | Extra          |
+------------------------+-------------------------------------+------+-----+---------+----------------+
| Extraction_Sample_ID   | int(11)                             |      | PRI | NULL    | auto_increment |
| FK_Sample__ID          | int(11)                             |      | MUL | 0       |                |
| FK_Library__Name       | char(6)                             | YES  |     | NULL    |                |
| Tube_Number            | int(11)                             | YES  |     | NULL    |                |
| Volume                 | int(11)                             | YES  |     | NULL    |                |
| FKOriginal_Plate__ID   | int(11)                             | YES  | MUL | NULL    |                |
| Extraction_Sample_Type | enum('DNA','RNA','Protein','Mixed') |      |     | Mixed   |                |
+------------------------+-------------------------------------+------+-----+---------+----------------+</pre></li><li style="list-style-type: circle"><p>This table is analagous to the Clone_Sample table, except it stores information relevant to Gene Expressiion samples.</p></li><li style="list-style-type: circle"><p>Extraction_Details</p></li><li style="list-style-type: circle"><pre class="programlisting">+------------------------------+---------------------------------------------------------------------+------+-----+---------+----------------+
| Field                        | Type                                                                | Null | Key | Default | Extra          |
+------------------------------+---------------------------------------------------------------------+------+-----+---------+----------------+
| Extraction_Details_ID        | int(11)                                                             |      | PRI | NULL    | auto_increment |
| FK_Extraction_Sample__ID     | int(11)                                                             |      | MUL | 0       |                |
| RNA_Isolated_Date            | date                                                                | YES  |     | NULL    |                |
| FKIsolated_Employee__ID      | int(11)                                                             | YES  | MUL | NULL    |                |
| Disruption_Method            | enum('Homogenized','Sheared')                                       | YES  |     | NULL    |                |
| Isolation_Method             | enum('Trizol','Qiagen Kit')                                         | YES  |     | NULL    |                |
| Resuspension_Volume          | int(11)                                                             | YES  |     | NULL    |                |
| Resuspension_Volume_Units    | enum('ul')                                                          | YES  |     | NULL    |                |
| Amount_RNA_Source_Used       | int(11)                                                             | YES  |     | NULL    |                |
| Amount_RNA_Source_Used_Units | enum('Cells','Gram of Tissue','Embryos','Litters','Organs','ug/ng') | YES  |     | NULL    |                |
| FK_Agilent_Assay__ID         | int(11)                                                             |      | MUL | 0       |                |
| Assay_Quality                | enum('Degraded','Partially Degraded','Good')                        | YES  |     | NULL    |                |
| Assay_Quantity               | int(11)                                                             | YES  |     | NULL    |                |
| Assay_Quantity_Units         | enum('ug/ul','ng/ul','pg/ul')                                       | YES  |     | NULL    |                |
| Total_Yield                  | int(11)                                                             | YES  |     | NULL    |                |
| Total_Yield_Units            | enum('ug','ng','pg')                                                | YES  |     | NULL    |                |
+------------------------------+---------------------------------------------------------------------+------+-----+---------+----------------+</pre></li><li style="list-style-type: circle"><p>This table is analagous to the Clone_Details table, except it stores information relevant to Gene Expressiion samples.</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e15217"></a>12.6.3.&nbsp;Coding</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>alDente::Extraction_Sample</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>home_info() - Display home page for extraction sample.</p></li></ul></div></li><li style="list-style-type: circle"><p>alDente::Container_Set</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>transfer() - creation of Extraction and Extraction_Sample table entries during an extraction step.</p></li><li style="list-style-type: circle"><p>view_ancestry() - Allow viewing of ancestry info for extraction steps.</p></li><li style="list-style-type: circle"><p>get_parent_sets() - Include extraction parents as parent plate sets.</p></li><li style="list-style-type: circle"><p>get_child_sets() - Include extraction children as child plate sets.</p></li></ul></div></li><li style="list-style-type: circle"><p>alDente::Tube</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>withdraw_sample() - updates the quantity fields of the Tube table during an extraction step.</p></li></ul></div></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e15254"></a>12.7.&nbsp;Library Submission</h3></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e15257"></a>12.7.1.&nbsp;Overview</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>In Sequencing lab, only lab admins are able to create new libraries</p></li><li style="list-style-type: circle"><p>Collaborators and internal GSC users other than lab admins create new libraries via a submission. ; There are 2 types of library submissions:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>External submission - these submissions are created via Kevins' GSC Sequencing Library Submission page.</p></li><li style="list-style-type: circle"><p>Internal submission - these submissions are created via the multipage form mechanism of the LIMS web page.</p></li></ul></div></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e15275"></a>12.7.2.&nbsp;Database tables</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Submission</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><pre class="programlisting">+--------------------------+--------------------------------------------------------------------------------------+------+-----+---------+----------------+
| Field                    | Type                                                                                 | Null | Key | Default | Extra          |
+--------------------------+--------------------------------------------------------------------------------------+------+-----+---------+----------------+
| Submission_ID            | int(11)                                                                              |      | PRI | NULL    | auto_increment |
| Submission_DateTime      | datetime                                                                             | YES  |     | NULL    |                |
| Submission_Source        | enum('External','Internal')                                                          | YES  |     | NULL    |                |
| Submission_Status        | enum('Submitted','Partially Approved','Approved','Completed','Cancelled','Rejected') | YES  |     | NULL    |                |
| FK_Contact__ID           | int(11)                                                                              | YES  |     | NULL    |                |
| FKSubmitted_Employee__ID | int(11)                                                                              | YES  |     | NULL    |                |
| Submission_Comments      | text                                                                                 | YES  |     | NULL    |                |
| FKApproved_Employee__ID  | int(11)                                                                              | YES  |     | NULL    |                |
| Approved_DateTime        | datetime                                                                             | YES  |     | NULL    |                |
+--------------------------+--------------------------------------------------------------------------------------+------+-----+---------+----------------+</pre></li><li style="list-style-type: circle"><p>One record generated for one library submission.</p></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Submission_Detail</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><pre class="programlisting">+--------------------------+-------------+------+-----+---------+----------------+
| Field                    | Type        | Null | Key | Default | Extra          |
+--------------------------+-------------+------+-----+---------+----------------+
| Submission_Detail_ID     | int(11)     |      | PRI | NULL    | auto_increment |
| FK_Submission__ID        | int(11)     |      |     | 0       |                |
| FKSubmission_DBTable__ID | int(11)     |      |     | 0       |                |
| Reference                | varchar(40) |      |     |         |                |
+--------------------------+-------------+------+-----+---------+----------------+</pre></li><li style="list-style-type: circle"><p>One to many records generated for one library submission, depending on how many table entities are included in the submission. ; For instance, a sequencing library submission of a SAGE library in Ligation format with 2 primers will generate a total of 7 records:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>1 record that references the Library table</p></li><li style="list-style-type: circle"><p>1 record that references the Sequencing_Library table</p></li><li style="list-style-type: circle"><p>1 record that references the SAGE_Library table</p></li><li style="list-style-type: circle"><p>1 record that references the Library_Container table</p></li><li style="list-style-type: circle"><p>1 record that references the Ligation table</p></li><li style="list-style-type: circle"><p>2 records that reference the LibraryPrimer table</p></li></ul></div></li><li style="list-style-type: circle"><p>Note that the references to the database tables are done through the FKSubmission_DBTable__ID field. ; In addition, the Reference field stores the primary field value of the referenced table entry created by the submission. ; (e.g. Library_Name for the Library table, Sequencing_Library_ID for the Sequencing_Library table, etc)</p></li></ul></div></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e15325"></a>12.7.3.&nbsp;Implementation Details</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Generation of external submission:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Collaborators go to GSC public web site (<a href="http://www.bcgsc.ca" target="_top">www.bcgsc.ca</a>) and go to "Collaborator Access" under the "Additional Access" section.</p></li><li style="list-style-type: circle"><p>After loggin in, go to "Sequencing Library submissions" under the "Additional Access" section.</p></li><li style="list-style-type: circle"><p>Collaborators will the go through the multipage library submission form and input library information:</p></li><li style="list-style-type: circle"><div class="screenshot"><div><img src="resources/GSC_Lib_Submission_Form.png"></div></div></li><li style="list-style-type: circle"><p>After the forms are finished, the following will be created:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>A new entry in the Submission table:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><pre class="programlisting">+---------------+---------------------+-------------------+-------------------+----------------+--------------------------+---------------------+-------------------------+-------------------+
| Submission_ID | Submission_DateTime | Submission_Source | Submission_Status | FK_Contact__ID | FKSubmitted_Employee__ID | Submission_Comments | FKApproved_Employee__ID | Approved_DateTime |
+---------------+---------------------+-------------------+-------------------+----------------+--------------------------+---------------------+-------------------------+-------------------+
|           420 | 2004-06-04 11:12:48 | External          | Submitted         |            347 |                     NULL | NULL                |                    NULL | NULL              |
+---------------+---------------------+-------------------+-------------------+----------------+--------------------------+---------------------+-------------------------+-------------------+</pre></li></ul></div></li><li style="list-style-type: circle"><p>A new submission file under '/home/sequence/www/htdocs/external_submissions/', with a name such as '2004-06-04_11:12:45.347.420', where '347' is the contact ID of the user who submitted the library and '420' is the submission ID.</p></li></ul></div></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Generation of internal submission:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Sequencing libraries are also submitted by internal GSC users. ; Currently this is pretty much exclusively done by the Gene Expression lab admins when they want to submit a library to the Sequencing lab. ; This is done thru the 'Submit new Sequencing Library' link under the 'Sequencing Library Submissions' section in the Gene Expression Admin page.</p></li><li style="list-style-type: circle"><p>User will go through the multipage form and input library info.</p></li><li style="list-style-type: circle"><p>After the forms are finished, the following will be created:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>A new entry in the Submission table:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><pre class="programlisting">
+---------------+---------------------+-------------------+-------------------+----------------+--------------------------+---------------------+-------------------------+-------------------+
| Submission_ID | Submission_DateTime | Submission_Source | Submission_Status | FK_Contact__ID | FKSubmitted_Employee__ID | Submission_Comments | FKApproved_Employee__ID | Approved_DateTime |
+---------------+---------------------+-------------------+-------------------+----------------+--------------------------+---------------------+-------------------------+-------------------+
|           430 | 2004-06-30 10:14:23 |           |          |           NULL |                      143 | NULL                |                     NULL| NULL              |
+---------------+---------------------+-------------------+-------------------+----------------+--------------------------+---------------------+-------------------------+-------------------+</pre></li></ul></div></li><li style="list-style-type: circle"><p>A new submission file under '/opt/alDente/www/dynamic/submissions/', with a name such as '2004-06-29_10:33:04.143.441', where '143' is the employee ID of the user who submitted the library and '441' is the submission ID.</p></li></ul></div></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Approval of submission:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>For both external and internal submissions, email notification will be sent to the Sequencing lab admins when the submission is created. ;</p></li><li style="list-style-type: circle"><p>Sequencing lab admins can view/edit/approve submissions from the Sequencing Admin page -&gt; 'Check Submissions' under the 'Admin Operations' section. ; A list of submissions will then be shown:</p></li><li style="list-style-type: circle"><div class="screenshot"><div><img src="resources/Check_Submissions.png"></div></div></li><li style="list-style-type: circle"><p>Clicking on a submission (e.g. submission ID 420) will retrieve the info included in that submission:</p></li><li style="list-style-type: circle"><div class="screenshot"><div><img src="resources/Retrieve_Submission.png"></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Notice that the message on the top indicates where the information is read from. ; In this case, it is from the file '2004-06-04_11:12:45.347.420.mapped'. ; This file is generated by the _map_submission() subroutine in DBinput.pm - basically, this hash is the mapped version of the submission hash generated by Kevin's page (see below).</p></li><li style="list-style-type: circle"><p>The table displays all the values that were submitted with their corresponding database fields.</p></li><li style="list-style-type: circle"><p>In the bottom there are various links/options for the lab admin:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Edit Submission - Allows user to cycle through the multipage form and view/edit info of the library submission. ; After the multipage form is cycled through, a new file will be generated under the submission directory (e.g. 2004-06-04_11:12:45.347.420.modified). ; This file has the same format as the corresponding *.mapped file, except the *.modified file contains the modifications of information by the lab admin. (i.e. the *.mapped file always contains information from the original submission by the user)</p></li><li style="list-style-type: circle"><p>Edit Submission as a re-submission - Allows the submission to be edit as a re-submission (see below)</p></li><li style="list-style-type: circle"><p>Cancel submission - Sets the submission status to 'Cancelled'. ; This is used when the submission was created by mistake or the lab admin simply want to cancel the submission.</p></li><li style="list-style-type: circle"><p>Reject submission - Sets the submission status ; to 'Rejected'. ; This is used when the submission is to be rejected.</p></li><li style="list-style-type: circle"><p>View/Edit Submission Info - This allows view/edit operation on the Submission table itself.</p></li></ul></div></li><li style="list-style-type: circle"><p>Notice that at this point there is no option for the lab admin to approve the submission. ; This is because of one or more of the followings:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>If the submission is for a new library and a library name is not yet specified by the lab admin.</p></li><li style="list-style-type: circle"><p>If the submission does not have a library container barcode label specified yet.</p></li></ul></div></li><li style="list-style-type: circle"><p>Once all required information is there, then 'Approve submission and update database' link will appear, allowing lab admin to set the submission status to 'Approved' and enter all the information into the corresponding tables (i.e. Library, Sequencing_Library, etc.). ; The Submission and Submission_Detail table will have the following entries:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Submission table:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><pre class="programlisting">+---------------+---------------------+-------------------+-------------------+----------------+--------------------------+---------------------+-------------------------+---------------------+
| Submission_ID | Submission_DateTime | Submission_Source | Submission_Status | FK_Contact__ID | FKSubmitted_Employee__ID | Submission_Comments | FKApproved_Employee__ID | Approved_DateTime   |
+---------------+---------------------+-------------------+-------------------+----------------+--------------------------+---------------------+-------------------------+---------------------+
|           420 | 2004-06-04 11:12:48 | External          | Approved          |            347 |                     NULL | NULL                |                     152 | 2004-07-05 13:47:53 |
+---------------+---------------------+-------------------+-------------------+----------------+--------------------------+---------------------+-------------------------+---------------------+</pre></li><li style="list-style-type: circle"><p>Note that Submission_Status is set to 'Approved', with FKApproved_Employee__ID and Approved_DateTime populated as well.</p></li></ul></div></li><li style="list-style-type: circle"><p>Submission_Detail table:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><pre class="programlisting">+----------------------+-------------------+--------------------------+-----------+
| Submission_Detail_ID | FK_Submission__ID | FKSubmission_DBTable__ID | Reference |
+----------------------+-------------------+--------------------------+-----------+
|                 1112 |               420 |                       40 | GQ123     |
|                 1113 |               420 |                      143 | 1035      |
|                 1114 |               420 |                       91 | 783       |
|                 1115 |               420 |                      155 | 20        |
|                 1116 |               420 |                       56 | 118       |
|                 1117 |               420 |                       86 | 82        |
|                 1118 |               420 |                       41 | 576       |
+----------------------+-------------------+--------------------------+-----------+</pre></li><li style="list-style-type: circle"><p>In this case, the references are:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>DBTable_ID of 40 ; ; = Library (Submission_Detail.Reference = Library.Library_Name = 'GQ123')</p></li><li style="list-style-type: circle"><p>DBTable_ID of 143 = Sequencing_Library (Submission_Detail.Reference = Sequencing_Library.Sequencing_Library_ID = 1035)</p></li><li style="list-style-type: circle"><p>DBTable_ID of 91 ; ; = cDNA_Library (Submission_Detail.Reference = cDNA_Library.cDNA_Library_ID = 783)</p></li><li style="list-style-type: circle"><p>DBTable_ID of 155 = Library_Container (Submission_Detail.Reference = Library_Container.Library_Container_ID = 20)</p></li><li style="list-style-type: circle"><p>DBTable_ID of 56 ; ; = Organization (Submission_Detail.Reference = Organization.Organization_ID = 118)</p></li><li style="list-style-type: circle"><p>DBTable_ID of 86 ; ; = Microtiter (Submission_Detail.Reference = Microtiter.Microtiter_ID = 82)</p></li><li style="list-style-type: circle"><p>DBTable_ID of 41 ; ; = LibraryPrimer (Submission_Detail.Reference = LibraryPrimer.LibraryPrimer_ID = 576)</p></li></ul></div></li></ul></div></li></ul></div></li></ul></div></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Library re-submission</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Sometimes a given library ran out of materials and the user have to re-submit additional materials for an existing library. ; Usually this is submitted in the same library format as before (i.e. Ligation, Microtiter, Xformed_Cells), but in theory it can come in a different format. ; Re-submissions only specify information related to the library format (i.e. Ligation, Microtiter, Xformed_Cells), library container (i.e. Library_Container table) and the primers (i.e. LibraryPrimer table). ; Re-submission can be both of External type or Internal type:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>External - This is done via Kevin's GSC Library Submission Page, with the 'Use existing library' radio button selected instead of the 'Create new library' button in the 'Choose Library' form.</p></li><li style="list-style-type: circle"><p>Internal - This is done in the Gene Expression Admin page, via 'Resubmit existing Sequencing Library XXXXX in the format of: XXX' under the 'Sequencing Library Submissions' section.</p></li></ul></div></li><li style="list-style-type: circle"><p>It is also possible to create re-submission on a complete submission using the 'Edit Submission as a re-submission link' when the submission is retrieved. ; In this case, information contained in tables other than the re-submission tables will not be entered into the database.</p></li></ul></div></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e15522"></a>12.7.4.&nbsp;Coding</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Generation of external submission:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>The pages for this is written by Kevin in Python and is outside the LIMS code base.</p></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Generation of internal submission:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>'Sequencing Library Submissions' section in the Gene Expression Admin page:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>alDente::Admin::Admin_page()</p></li></ul></div></li><li style="list-style-type: circle"><p>Multipage form for library submission information:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Methods in SDB::DB_Form (refer to the Multipage Form Developer's Manual)</p></li></ul></div></li><li style="list-style-type: circle"><p>Creation of submission:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>SDB::Submission::Generate_Submission()</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Generates the submission file in/opt/alDente/www/dynamic/submissions/.</p></li><li style="list-style-type: circle"><p>Creates the new entry in the Submission table and sets itsstatus to 'Submitted'.</p></li><li style="list-style-type: circle"><p>Send email notifications to:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Sequencing lab admins - This contains brief information such assubmission ID, who submitted the library and submissiondatetime.</p></li><li style="list-style-type: circle"><p>The person who submit the library - This contains details andinformation specified in the submission.</p></li></ul></div></li></ul></div></li></ul></div></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Approval of submission:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Sequencing Admin page -&gt; 'Check Submissions' under the'Admin Operations' section:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>alDente::Admin::Admin_page()</p></li></ul></div></li><li style="list-style-type: circle"><p>Showing a list of submissions:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>SDB::Submission::Check_Submissions()</p></li></ul></div></li><li style="list-style-type: circle"><p>Retrieving details of a given submission:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>SDB::Submission::Retrieve_Submission()</p></li></ul></div></li><li style="list-style-type: circle"><p>Generating multipage forms with submission information</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>SDB::DBinput::Load_Submission(), with $action = 'edit'</p></li><li style="list-style-type: circle"><p>alDente::Special_Branches::Post_DBForm_Skip()</p></li></ul></div></li><li style="list-style-type: circle"><p>Mapping external submission generated by Kevin to tableentities in the sequence database (</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Whenever Kevin modifies the fields to be included in an external submission from his site, or if we change the database table schema for the submission tables on our side, this is the place where we need to pay attention to so we make the necessary changes</p></div></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>SDB::DBinput::_map_submission()</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>This function maps the data structure generated from Kevin toour structure. ; For example:</p></li></ul></div></li></ul></div></li></ul></div></li><li style="list-style-type: circle"><pre class="programlisting">$submission{Library_Name}{1} = 'PX005'  (General format = $submission{&lt;FIELD&gt;}{&lt;RECORD_INDEX&gt;}) 
$submission{Blue_white_selection}{1} = 1</pre><p>becomes</p><pre class="programlisting">$submission{tables}{Library}{1}{Library_Name} = 'PX005' (General format = $submission{table}{&lt;TABLE&gt;}{&lt;RECORD_INDEX&gt;}{&lt;FIELD&gt;})
$submission{tables}{cDNA_Library}{1}{Blue_White_Selection} = 'Yes' </pre></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Saving modification by lab admins to the submission *.modified file:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>SDB::Submission::Modify_Submission()</p></li></ul></div></li><li style="list-style-type: circle"><p>Approving submission and saving information to the database:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>SDB::DBinput::Load_Submission(), with $action = 'add'</p></li></ul></div></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e15664"></a>12.8.&nbsp;Multipage Form</h3></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e15667"></a>12.8.1.&nbsp;Overview</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>The Multipage Form allows users to input information over multiple pages of forms and at the very end insert the database into the database in a batch.</p></li><li style="list-style-type: circle"><p>The insertion of data is wrapped inside a transaction (See Developer's Manual - Transaction). ; Hence, either all data from the multipage forms will be inserted or none at all.</p></li><li style="list-style-type: circle"><p>The order of forms to show up in the multipage form is configured via a database table - hence no hardcoding of form sequences is required.</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e15680"></a>12.8.2.&nbsp;Database tables</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>DB_Form</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><pre class="programlisting">+----------------------+--------------+------+-----+---------+----------------+
| Field                | Type         | Null | Key | Default | Extra          |
+----------------------+--------------+------+-----+---------+----------------+
| DB_Form_ID           | int(11)      |      | PRI | NULL    | auto_increment |
| Form_Table           | varchar(80)  |      |     |         |                |
| Form_Order           | int(2)       | YES  |     | 1       |                |
| Min_Records          | int(2)       |      |     | 1       |                |
| Max_Records          | int(2)       |      |     | 1       |                |
| FKParent_DB_Form__ID | int(11)      | YES  |     | NULL    |                |
| Parent_Field         | varchar(80)  | YES  |     | NULL    |                |
| Parent_Value         | varchar(200) | YES  |     | NULL    |                |
+----------------------+--------------+------+-----+---------+----------------+</pre></li><li style="list-style-type: circle"><p>This table contains configurations on the ordering of tables/forms to be shown in a multipage form.</p></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Field descriptions:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Form_Table - The name of the table</p></li><li style="list-style-type: circle"><p>Form_Order - This is usually set to '1'. ; However, in the case where several tables are candidates for the next form in a given branch, this field becomes relevant (more on this later)</p></li><li style="list-style-type: circle"><p>Min_Records - The minimum number of records to be prompted for the table. ; Special values are:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>'0' - Data input is optional. ; In this case, a 'Skip' button will be avaiable for the user to skip the form.</p></li></ul></div></li><li style="list-style-type: circle"><p>Max_Records - The maximum number of records to be prompted for the table. ; Special values are:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>'-1' - This corresponds to 'n' number of records, meaning the user can specify as many records as they can. ;</p></li></ul></div></li><li style="list-style-type: circle"><p>FKParent_DB_Form__ID - The DB_Form_ID of the parent table</p></li><li style="list-style-type: circle"><p>Parent_Field and Parent_Value - This is specified if the branching should occurs only if the value in the Parent_Value field is the one specified by the user for the field in Parent_Field field.</p></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Example for the Pool related tables:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>The order of tables that we want to show is:</p></li><li style="list-style-type: circle"><div class="screenshot"><div><img src="resources/DB_Form_Example.png"></div></div></li><li style="list-style-type: circle"><p>The following is what we need in the DB_Form table to allow this to happen:</p></li><li style="list-style-type: circle"><pre class="programlisting">+------------+-----------------+------------+-------------+-------------+----------------------+-------------------+--------------+
| DB_Form_ID | Form_Table      | Form_Order | Min_Records | Max_Records | FKParent_DB_Form__ID | Parent_Field      | Parent_Value |
+------------+-----------------+------------+-------------+-------------+----------------------+-------------------+--------------+
|         19 | Pool            |          1 |           1 |           1 |                 NULL | NULL              | NULL         |
|         20 | Transposon_Pool |          1 |           1 |           1 |                   29 | Library_Pool_Type | Transposon   |
|         21 | PoolSample      |          2 |           1 |          -1 |                   29 | NULL              | NULL         |
|         29 | Library_Pool    |          1 |           1 |           1 |                   19 | Pool_Type         | Library      |
|         39 | Sample_Pool     |          1 |           1 |           1 |                   19 | Pool_Type         | Sample       |
|         40 | PoolSample      |          1 |           1 |          -1 |                   39 | NULL              | NULL         |
+------------+-----------------+------------+-------------+-------------+----------------------+-------------------+--------------+ </pre><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Note that the starting table (Pool) does not have FKParent_DB_Form__ID.</p></li><li style="list-style-type: circle"><p>Either Library_Pool or Sample_Pool will be next. ; This is determined based on whether Pool.Pool_Type = 'Library' or 'Sample'.</p></li><li style="list-style-type: circle"><p>If we go to Library_Pool:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>We will then go to Transposon_Pool if Library_Pool.Library_Pool_Type = 'Transposon'; otherwise go directly to PoolSample.</p></li><li style="list-style-type: circle"><p>Notice that DB_Form_ID 21 (PoolSample) has a form order of '2'. ; This indicates that in the event of the Transposon_Pool table being included in the form series, the system will first display the Transposon_Pool table (Form_Order = 1) and then the PoolSample table (Form_Order = 2)</p></li></ul></div></li><li style="list-style-type: circle"><p>If we go to Sample_Pool, then we will still go to PoolSample table as our last table.</p></li><li style="list-style-type: circle"><p>Notice that there are 2 entries required for the 'PoolSample' table (i.e. ID 21 and 40). ; This is because PoolSample can be coming from 2 branches:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Library_Pool (ID of 29)</p></li><li style="list-style-type: circle"><p>Sample_Pool (ID of 39)</p></li></ul></div></li><li style="list-style-type: circle"><p>Finally, notice that Max_Records of PoolSample has a value of '-1', indicating that user can specify as many PoolSample entries as possible during the form (this is due to a one-to-many relationship)</p></li></ul></div></li></ul></div></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e15784"></a>12.8.3.&nbsp;Coding</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>The logic of the multipage form is inside the SDB::DB_Form object. ; Several key concepts:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>The 'mode' attribute indicates what submit buttons will be shown to the user. ; Note that this attribute contains a comma-delimited list of modes that are one of the following:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>'Normal' - This is used for single page form. ; The button displayed will be 'Update &lt;TABLE&gt;' ; (e.g. Update Project)</p></li><li style="list-style-type: circle"><p>And the followings are only applicable to a multi-page form:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>'Start' - This indicates the start of a new multipage form session</p></li><li style="list-style-type: circle"><p>'Continue' - This indicates there are more forms to be followed by the current form. ; The button displayed will be 'Continue'.</p></li><li style="list-style-type: circle"><p>'Skip' - This is the case for tables that have Min_Records of '0', meaning that the current form is optional and can be skipped. ; The button displayed will be 'Skip'.</p></li><li style="list-style-type: circle"><p>'Finish' - This indicates this form CAN be the last form of the series. ; The button displayed will be 'Finish' - upon clicking on this button, all the form data will be batch inserted into the database.</p></li></ul></div></li></ul></div></li></ul></div></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>The configure() method accepts a configuration hash. ; This controls which fields will be greyed out, hidden, preset, etc. ; For instance, if the Pool_Type is to be preset to 'Library' and Library_Pool_Type grey out to 'Transposon', you will do the following: </p><pre class="programlisting">my %configs;
$configs{-preset}{'Pool.Pool_Type'} = 'Library';
$configs{-grey}{'Library_Pool.Library_Pool_Type'} = 'Transposon';
$form-&gt;configure(%configs);</pre></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>To actually generate the form, you would call the public method generate(). ; Note that this method will pass in the corresponding configurations generated by the configure() method to the _generate_form() private method, which is the actual code that generates the form.</p></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>After the user click on a button to go to the next page and all the necessary data storage or update has been done, the code goes back to alDente::Button_Options, in which it receives the parameter 'Multipage_Form'. ; Note that the Multipage_Form parameter actually contains the frozen/encoded copy of the DB_Form object itself, including the all the data from the previous forms (note that the data are stored in the 'data' attribute of the DB_Form object). ; So at this point if the mode is not 'Finish', then Button_Options will re-create the DB_Form object based on the frozen/encoded copy and the next form page will be generated by calling the generate() method.</p></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>At this point, the sequence of events that happened during the entire multipage form session is rather confusing (we should clean up this when we have the chance). ; So here I will try to illustrate what actually happens:</p></li><li style="list-style-type: circle"><p>Generation of the form:</p><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>DB_Form-&gt;new() - Constructor of the DB_Form object</p></li><li style="list-style-type: circle"><p>DB_Form-&gt;configure() - Configuration for the entiremultipage form</p></li><li style="list-style-type: circle"><p>DB_Form-&gt;generate() - Generates the first form</p></li></ul></div></li><li style="list-style-type: circle"><p>After user clicked on 'Continue':</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Goes to SDB::DB_Form_Viewer::DB_Viewer_Branch() and inside itcalls:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>alDente::Validation::Validate_Form_Info() - Performs validationon user input (e.g. mandatory fields, field formats, etc)</p></li><li style="list-style-type: circle"><p>SDB::DB_Form_Viewer::_update_record(). ; Inside thisroutine:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Appends the data from the previous form to data gathered from earlier forms.</p></li></ul></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>If we are inside a submission, then also writes the data into the submission file.</p></li></ul></div></li></ul></div></li><li style="list-style-type: circle"><p>Goes to alDente::Special_Branches::Post_DBForm_Skip() and see if there are any special operations to be done for the previous form</p></li><li style="list-style-type: circle"><p>Goes to alDente::Button_Options::Check_Button_Options, and under the section that receives the 'Multipage_Form' param, it thaws/decodes the frozen/encoded DB_Form object, calls configure() and generate() to generate the next form.</p></li></ul></div></li><li style="list-style-type: circle"><p>After user clicked on 'Finish':</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Goes to SDB::DB_Form_Viewer::DB_Viewer_Branch() and inside it calls:</p></li><li style="list-style-type: circle"><p>alDente::Validation::Validate_Form_Info() - Performs validation on user input (e.g. mandatory fields, field formats, etc)</p></li><li style="list-style-type: circle"><p>SDB::DB_Form_Viewer::_update_record(). ; Inside this routine, it calls SDB::GSDB::Batch_Append() to batch insert all form data into the database. ; Notice that this is wrapped inside a transaction.</p></li></ul></div></li><li style="list-style-type: circle"><p>Goes to alDente::Special_Branches::Post_DBForm_Skip() and see if there are any special operations to be done for the last form. ; After this the transaction will be comitted. ; Then at the end, it checks the new IDs and see if any barcode labels will need to be printed.</p></li><li style="list-style-type: circle"><p>Goes to alDente::Button_Options::Check_Button_Options, and under the section that receives the 'Multipage_Form' param, it will return to the home page.</p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e15900"></a>12.9.&nbsp;MySQL Databases</h3></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e15903"></a>12.9.1.&nbsp;Overview</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>The LIMS system uses MySQL databases as the backend databases.</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e15910"></a>12.9.2.&nbsp;Details</h4></div></div></div><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>The LIMS has variuos MySQL databases setup on 2 hosts:</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>seqdb01 host</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>sequence database</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Production database</p></li></ul></div></li><li style="list-style-type: circle"><p>seqtest database</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Testing database for production release</p></li><li style="list-style-type: circle"><p>Restored from sequence database every night (exceptClone_Sequence table)</p></li><li style="list-style-type: circle"><p>To be used for testing hotfixes for production release</p></li></ul></div></li></ul></div></li><li style="list-style-type: circle"><p>lims-dbm host</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>sequence database</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>Replicated/mirrored version of the sequence database on seqdb01(see details on Replication)</p></li><li style="list-style-type: circle"><p>A read-only database, mostly used by bioinformatics users toquery data</p></li></ul></div></li><li style="list-style-type: circle"><p>seqdev database</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>To be used for beta testing</p></li></ul></div></li><li style="list-style-type: circle"><p>individual developer's databases (e.g. seqrguin, seqjsantos, seqechuah)</p></li><li style="list-style-type: circle"><div class="itemizedlist"><ul type="opencircle"><li style="list-style-type: circle"><p>To be used for ongoing development by individual developers</p></li></ul></div></li></ul></div></li></ul></div></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e15978"></a>12.10.&nbsp;DevMan_PerlWarning.xml</h3></div></div></div><p>Needs to be converted to DocBook...</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e15983"></a>12.11.&nbsp;DevMan_Pooling.xml</h3></div></div></div><p>Needs to be converted to DocBook...</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e15988"></a>12.12.&nbsp;DevMan_Rack.xml</h3></div></div></div><p>Needs to be converted to DocBook...</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e15993"></a>12.13.&nbsp;DevMan_RNASources.xml</h3></div></div></div><p>Needs to be converted to DocBook...</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e15998"></a>12.14.&nbsp;DevMan_SecuritySystem.xml</h3></div></div></div><p>Needs to be converted to DocBook...</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e16003"></a>12.15.&nbsp;DevMan_SysMonitor.xml</h3></div></div></div><p>Needs to be converted to DocBook...</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e16008"></a>12.16.&nbsp;DevMan_Transaction.xml</h3></div></div></div><p>Needs to be converted to DocBook...</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch20s11.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch20.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch20s13.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">11.&nbsp;LIMS Test Protocol - Live database test (<span class="emphasis"><em>use Beta database</em></span>)&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;13.&nbsp;Internal System Testing</td></tr></table></div></body></html>